
# 1
-- Создание таблицы Вид собственности
CREATE TABLE vids (
    id_vs SERIAL PRIMARY KEY,
    abr VARCHAR(10) NOT NULL,
    name VARCHAR(100) NOT NULL
);

-- Заполнение таблицы Вид собственности
INSERT INTO vids (abr, name) VALUES
('ИП', 'Индивидуальный предприниматель'),
('ООО', 'Общество с ограниченной ответственностью'),
('ПАО', 'Публичное акционерное общество'),
('НАО', 'Непубличное акционерное общество'),
('ПК', 'Производственный кооператив');

-- Создание таблицы Продавцы
CREATE TABLE salespeople (
    id_s SERIAL PRIMARY KEY,
    snazv VARCHAR(100) NOT NULL,
    city VARCHAR(50) NOT NULL,
    tel VARCHAR(20) NOT NULL,
    naprav VARCHAR(100) NOT NULL,
    comm NUMERIC(4,2) CHECK (comm BETWEEN 0.10 AND 0.20) NOT NULL,
    id_vs INT NOT NULL REFERENCES vids(id_vs)
);

-- Заполнение таблицы Продавцы
INSERT INTO salespeople (snazv, city, tel, naprav, comm, id_vs) VALUES
('Ветров', 'Казань', '8-900-375-15-65', 'кондитерские изделия', 0.12, 1),
('Монтаж', 'Нижний Новгород', '+7 (831) 224-16-16', 'трикотажная продукция', 0.13, 2),
('СтройМаркт', 'Казань', '+7 (432) 115-66-66', 'кондитерские изделия', 0.11, 2),
('Костин', 'Новочеркасск', '8-938-715-63-28', 'кондитерские изделия', 0.15, 1),
('Семёнов', 'Ростов-на-Дону', '8-960-368-58-96', 'строй.материалы', 0.10, 1);

-- Создание таблицы Заказчики физ. лица
CREATE TABLE customers_fiz (
    id_cf SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    city VARCHAR(50) NOT NULL,
    pol CHAR(1) CHECK (pol IN ('м', 'ж')) NOT NULL,
    gr DATE CHECK (gr <= CURRENT_DATE - INTERVAL '18 years') NOT NULL,
    skidka INT DEFAULT 0
);

-- Заполнение таблицы Заказчики физ. лица
INSERT INTO customers_fiz (name, city, pol, gr) VALUES
('Астахов И.И.', 'Казань', 'м', '1997-01-02'),
('Зверев С.Н.', 'Калуга', 'м', '1987-09-12'),
('Янкин В.И.', 'Нижний Новгород', 'м', '1997-05-13'),
('Борн А.В.', 'Брянск', 'м', '1990-04-18'),
('Гришина П.П.', 'Казань', 'ж', '1991-07-21'),
('Свиридова А.Г.', 'Нижний Новгород', 'ж', '2004-08-25'),
('Паршин Р.Р.', 'Калуга', 'м', '1997-08-28');

-- Создание таблицы Заказчики юр. лица
CREATE TABLE customers_yur (
    id_cy SERIAL PRIMARY KEY,
    ynazv VARCHAR(100) NOT NULL,
    city VARCHAR(50) NOT NULL,
    rating INT CHECK (rating BETWEEN 100 AND 500) NOT NULL,
    id_vs INT NOT NULL DEFAULT 2 REFERENCES vids(id_vs)
);

-- Заполнение таблицы Заказчики юр. лица
INSERT INTO customers_yur (ynazv, city, rating, id_vs) VALUES
('Алые паруса', 'Липецк', 100, 2),
('Южный ветер', 'Ростов-на-Дону', 200, 2),
('СтройИнвест', 'Самара', 200, 2),
('Курочка', 'Белгород', 300, 3),
('Нива', 'Липецк', 100, 3),
('Атлант', 'Самара', 300, 4),
('Канцлер', 'Ростов-на-Дону', 100, 2);

-- Создание таблицы Заказы
CREATE TABLE orders (
    id_z SERIAL PRIMARY KEY,
    amt NUMERIC(10,2) NOT NULL,
    dostavka NUMERIC(10,2) CHECK ((amt <= 11000) OR (dostavka IS NULL)),
    odate DATE NOT NULL,
    id_s INT NOT NULL REFERENCES salespeople(id_s),
    id_cf INT REFERENCES customers_fiz(id_cf),
    id_cy INT REFERENCES customers_yur(id_cy)
);

-- Создание таблицы Скидки
CREATE TABLE skid (
    id_sk SERIAL PRIMARY KEY,
    skid INT NOT NULL,
    uslovie TEXT NOT NULL
);

-- Заполнение таблицы Скидки
INSERT INTO skid (skid, uslovie) VALUES
(10, 'Общая стоимость заказов больше 1500 руб'),
(15, 'Общая стоимость заказов больше 3000 руб'),
(20, 'Общая стоимость заказов больше 5000 руб');


# 2
# 3

# 4

# 5

# 6

# 7

# 8

# 9

# 10